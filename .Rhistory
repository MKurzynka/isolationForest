library(class)
nn3 = knn(irisTrain, irisTest, irisTrainTarget, k=3)
nn3
table(nn3, iris[130:nrow(iris), 5])
rm(list = ls())
setwd('/home/michal/R/Projects/isolationForest');
library(rmatio)
library(DMwR)
data = read.mat('mammography.mat')
attributesOfData = data[["X"]]
classOfData = data.frame(data[["y"]])
data = cbind(attributesOfData, classOfData)
data[is.na(data)] = 0
dataSize = nrow(data)
trainSetSize = floor(0.75 * dataSize)
testSetSize = dataSize - trainSetSize
set.seed(123)
trainIds = sample(seq_len(dataSize), size = trainSetSize)
trainData = data[trainIds, ]
testData= data[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], norm=FALSE,k=3)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=3)
nn3 = knn(irisTrain, irisTest, irisTrainTarget, k=21)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=21)
trainData[, 1:6]
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=21)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=1)
rm(list = ls())
data = read.mat('mammography.mat')
attributesOfData = data[["X"]]
classOfData = data.frame(data[["y"]])
data = cbind(attributesOfData, classOfData)
data[is.na(data)] = 0
dataSize = nrow(data)
trainSetSize = floor(0.75 * dataSize)
testSetSize = dataSize - trainSetSize
set.seed(123)
trainData = data[1:15, ]
testData= data[16:20, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=1)
trainData = data[1:100, ]
testData= data[101:120, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=1)
trainData = data[1:1000, ]
testData= data[1001:1020, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=1)
table(trainData[ ,7], testData[ ,7])
table(nn3, testData[ ,7])
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=10)
nn3
trainData[, 7]
trainData = data[1:5000, ]
testData= data[5001:5020, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=10)
trainData = data[1:5000, ]
trainData = data[1:2000, ]
plot(data[1:2000, 7])
trainData = data[1:2000, ]
testData= data[5001:5020, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=10)
plot(data[5001:5020, 7])
plot(data[5001:5800, 7])
trainData = data[1:2000, ]
testData= data[5001:5800, ]
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=10)
nn3
table(nn3, testData[ ,7])
trainData = data[1:2000, ]
testData= data[5001:5800, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=20)
table(nn3, testData[ ,7])
trainData = data[1:2000, ]
testData= data[5001:5800, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=4)
table(nn3, testData[ ,7])
trainData = data[1:2000, ]
testData= data[5001:5800, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
table(nn3, testData[ ,7])
trainData = data[1:2000, ]
testData= data[5001:5800, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=1)
table(nn3, testData[ ,7])
trainData = data[1:2000, ]
testData= data[5001:5800, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=3)
table(nn3, testData[ ,7])
trainData = data[1:4000, ]
testData= data[5001:5800, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=3)
table(nn3, testData[ ,7])
trainData = data[1:3000, ]
testData= data[5001:5800, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=3)
table(nn3, testData[ ,7])
trainData = data[1:3500, ]
testData= data[5001:5800, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=3)
trainData = data[1:3300, ]
testData= data[5001:5800, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=3)
table(nn3, testData[ ,7])
runif(2)
runif(2)/1e6
runif(3, 2)
runif(3, 2, 1)
runif(3, 3, 1)
runif(100, 100, 150)
runif(100, 100, 150)
runif(100, 100, 150)
runif(100, 100, 150)
runif(100, 100, 150)
runif(100, 100, 150)
runif(100, 100, 150)
runif(100, 100, 150)
runif(100, 100, 150)
runif(100, 100, 150)
cl = runif(100, 100, 150)
?runif
runif(nrow(trainData))
trainData = data[1:3300, ]
trainData = trainData[ ,1] + runif(nrow(trainData))
trainData = data[1:3300, ]
head(trainData)
trainData = data[1:3300, ]
trainData = as.data.frame(trainData[ ,1] + runif(nrow(trainData))/1e6)
testData= data[5001:5800, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=3)
table(nn3, testData[ ,7])
trainData = data[1:3300, ]
trainData = (trainData[ ,1] + runif(nrow(trainData))/1e6)
testData= data[5001:5800, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=3)
trainData[ ,1]
trainData = data[1:3300, ]
trainData = data[1:3300, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e6)
testData= data[5001:5800, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=3)
table(nn3, testData[ ,7])
trainData = data[1:5000, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e6)
testData= data[5001:5800, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=3)
table(nn3, testData[ ,7])
trainData = data[trainIds, ]
trainIds = sample(seq_len(dataSize), size = trainSetSize)
trainData = data[trainIds, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e6)
testData= data[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=3)
table(nn3, testData[ ,7])
trainData = data[trainIds, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e12)
testData= data[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=3)
table(nn3, testData[ ,7])
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
table(nn3, testData[ ,7])
trainIds = sample(seq_len(dataSize), size = trainSetSize)
trainData = data[trainIds, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e12)
testData= data[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
runif(nrow(trainData))/1e12
trainData = data[trainIds, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e12)
testData= data[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
table(nn3, testData[ ,7])
trainData = data[trainIds, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e12)
testData= data[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
table(nn3, testData[ ,7])
trainSetSize = floor(0.8 * dataSize)
testSetSize = dataSize - trainSetSize
set.seed(123)
trainIds = sample(seq_len(dataSize), size = trainSetSize)
trainData = data[trainIds, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e12)
testData= data[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
trainSetSize = floor(0.76 * dataSize)
testSetSize = dataSize - trainSetSize
set.seed(123)
trainIds = sample(seq_len(dataSize), size = trainSetSize)
trainData = data[trainIds, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e12)
testData= data[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
trainSetSize = floor(0.75 * dataSize)
testSetSize = dataSize - trainSetSize
set.seed(123)
trainIds = sample(seq_len(dataSize), size = trainSetSize)
trainData = data[trainIds, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e12)
testData= data[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e7)
testData= data[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
table(nn3, testData[ ,7])
trainSetSize = floor(0.9 * dataSize)
testSetSize = dataSize - trainSetSize
set.seed(123)
trainIds = sample(seq_len(dataSize), size = trainSetSize)
trainData = data[trainIds, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e7)
testData= data[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
table(nn3, testData[ ,7])
trainSetSize = floor(0.3 * dataSize)
testSetSize = dataSize - trainSetSize
set.seed(123)
trainIds = sample(seq_len(dataSize), size = trainSetSize)
trainData = data[trainIds, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e7)
testData= data[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
table(nn3, testData[ ,7])
trainSetSize = floor(0.7 * dataSize)
testSetSize = dataSize - trainSetSize
set.seed(123)
trainIds = sample(seq_len(dataSize), size = trainSetSize)
trainData = data[trainIds, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e7)
testData= data[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
table(nn3, testData[ ,7])
set.seed(123)
trainIds = sample(seq_len(dataSize), size = trainSetSize)
trainData = data[trainIds, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e7)
testData= data[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
table(nn3, testData[ ,7])
set.seed(123)
trainIds = sample(seq_len(dataSize), size = trainSetSize)
trainData = data[trainIds, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e7)
testData= data[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
table(nn3, testData[ ,7])
trainIds = sample(seq_len(dataSize), size = trainSetSize)
trainData = data[trainIds, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e7)
testData= data[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
table(nn3, testData[ ,7])
set.seed(123)
trainIds = sample(seq_len(dataSize), size = trainSetSize)
trainData = data[trainIds, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e7)
testData= data[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
table(nn3, testData[ ,7])
set.seed(123)
trainIds = sample(seq_len(dataSize), size = trainSetSize)
trainData = data[trainIds, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e7)
testData= data[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
table(nn3, testData[ ,7])
trainIds = sample(seq_len(dataSize), size = trainSetSize)
trainData = data[trainIds, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e7)
testData= data[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
table(nn3, testData[ ,7])
trainIds = sample(seq_len(dataSize), size = trainSetSize)
trainData = data[trainIds, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e7)
testData= data[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
table(nn3, testData[ ,7])
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=10)
table(nn3, testData[ ,7])
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=5)
table(nn3, testData[ ,7])
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=3)
table(nn3, testData[ ,7])
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
table(nn3, testData[ ,7])
set.seed(123)
trainIds = sample(seq_len(dataSize), size = trainSetSize)
trainData = data[trainIds, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e7)
testData= data[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
table(nn3, testData[ ,7])
head(data)
max(data)
min(data)
ndata = data[,1:6]
ndata = (ndata - min(ndata))/(max(ndata) - min(ndata))
head(ndata)
ndata = data
ndata = (ndata - min(ndata))/(max(ndata) - min(ndata))
dataSize = nrow(ndata)
trainSetSize = floor(0.7 * dataSize)
testSetSize = dataSize - trainSetSize
set.seed(123)
trainIds = sample(seq_len(dataSize), size = trainSetSize)
trainData = ndata[trainIds, ]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e7)
testData= ndata[-trainIds, ]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainData[, 7], k=2)
table(nn3, testData[ ,7])
ndata = data[ ,1:6]
ndata = (ndata - min(ndata))/(max(ndata) - min(ndata))
dataSize = nrow(ndata)
trainSetSize = floor(0.7 * dataSize)
testSetSize = dataSize - trainSetSize
set.seed(123)
ndata = data[ ,1:6]
ndata = (ndata - min(ndata))/(max(ndata) - min(ndata))
dataSize = nrow(ndata)
trainSetSize = floor(0.7 * dataSize)
testSetSize = dataSize - trainSetSize
set.seed(123)
trainIds = sample(seq_len(dataSize), size = trainSetSize)
trainData = ndata[trainIds, ]
trainClass = data[trainIds, 7]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e7)
testData= ndata[-trainIds, ]
testClass = data[-trainIds, 7]
ndata = data[ ,1:6]
ndata = (ndata - min(ndata))/(max(ndata) - min(ndata))
dataSize = nrow(ndata)
trainSetSize = floor(0.7 * dataSize)
testSetSize = dataSize - trainSetSize
set.seed(123)
trainIds = sample(seq_len(dataSize), size = trainSetSize)
trainData = ndata[trainIds, ]
trainClass = data[trainIds, 7]
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e7)
testData= ndata[-trainIds, ]
testClass = data[-trainIds, 7]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainClass, k=2)
table(nn3, testData[ ,7])
table(nn3, testClass)
head(ndata0)
head(ndata)
head(data)
rm(list = ls())
setwd('/home/michal/R/Projects/isolationForest');
library(rmatio)
library(DMwR)
data = read.mat('mammography.mat')
attributesOfData = data[["X"]]
classOfData = data.frame(data[["y"]])
data = cbind(attributesOfData, classOfData)
data[is.na(data)] = 0
ndata = data[ ,1:6]
# Normalizacja
ndata = (ndata - min(ndata))/(max(ndata) - min(ndata))
dataSize = nrow(ndata)
trainSetSize = floor(0.7 * dataSize)
testSetSize = dataSize - trainSetSize
set.seed(123)
trainIds = sample(seq_len(dataSize), size = trainSetSize)
trainData = ndata[trainIds, ]
trainClass = data[trainIds, 7]
## szum
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e7)
testData= ndata[-trainIds, ]
## szum
trainData[ ,1] = (trainData[ ,1] + runif(nrow(trainData))/1e12)
testData= ndata[-trainIds, ]
testClass = data[-trainIds, 7]
library(class)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainClass, k=2)
table(nn3, testClass)
max(ndata)
min(ndata)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainClass, k=3)
table(nn3, testClass)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainClass, k=10)
table(nn3, testClass)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainClass, k=2)
table(nn3, testClass)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainClass, k=2)
table(nn3, testClass)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainClass, k=2)
table(nn3, testClass)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainClass, k=2)
table(nn3, testClass)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainClass, k=2)
table(nn3, testClass)
table(nn3, testClass)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainClass, k=2)
table(nn3, testClass)
table(nn3, testClass)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainClass, k=2)
table(nn3, testClass)
nn3 <- knn(trainData[, 1:2], testData[, 1:2], trainClass, k=2)
table(nn3, testClass)
nn3 <- knn(trainData[, 1:3], testData[, 1:3], trainClass, k=2)
table(nn3, testClass)
nn3 <- knn(trainData[, 1:5], testData[, 1:5], trainClass, k=2)
table(nn3, testClass)
nn3 <- knn(trainData[, 4:5], testData[, 4:5], trainClass, k=2)
table(nn3, testClass)
nn3 <- knn(trainData[, 6], testData[, 6], trainClass, k=2)
nn3 <- knn(trainData[, 6], testData[, 6], trainClass, k=2)
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainClass, k=2)
table(nn3, testClass)
library("ROCR")
pred = prediction(nn3, testClass)
nn3
testClass
?prediction
?data
nn3 = as.numeric(nn3)
table(nn3, testClass)
library("ROCR")
pred = prediction(nn3, testClass)
perf = performance(pred, "tpr", "fpr")
plot(perf, col="blue")
abline(0, 1)
pred
perf
library("plotROC")
iinstall.packages("plotROC")
install.packages("plotROC")
library("plotROC")
?performance
pred = prediction(nn3, testClass)
perf = performance(pred, "tpr", "prec")
plot(perf, col="blue")
abline(0, 1)
perf = performance(pred, "tpr", "fpr")
plot(perf, col="blue")
abline(0, 1)
install.packages("pROC")
library("pROC")
?roc
nn3 <- knn(trainData[, 1:6], testData[, 1:6], trainClass, k=2)
nn3 = as.numeric(nn3)
table(nn3, testClass)
library("ROCR")
pred = prediction(nn3, testClass)
perf = performance(pred, "tpr", "fpr")
plot(perf, col="blue")
abline(0, 1)
roc(nn3, testClass, plot = TRUE)
roc(testClass, nn3, plot = TRUE)
library("e1071")
install.packages(e1071)
install.packages("e1071")
library("e1071")
svm = e1071::svm(trainData[, 1:6], 0.09, "one-svc", "linear")
svm = e1071::svm(trainData[, 1:6],nu=0.09, type="one-classification", kernel="linear")
out_svm = predict(svm)
out_svm
svm
out_svm = as.integer(predict(svm))
out_svm
?e1071::svm
svm = e1071::svm(trainData[, 1:6], nu=0.09, type="one-classification", kernel="radial basis")
svm = e1071::svm(trainData[, 1:6], nu=0.09, type="one-classification", kernel="sigmoid")
out_svm = as.integer(predict(svm))
out_svm
svm = e1071::svm(trainData[, 1:6], nu=0.09, type="one-classification", kernel="polynomial")
out_svm = as.integer(predict(svm))
out_svm
out_svm[out_svm == 0] = 2
out_svm[out_svm == 1] = 0
out_svm[out_svm == 2] = 1
table(out_svm, trainClass)
